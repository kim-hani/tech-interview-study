# 프로세스와 스레드

---

## 1. 프로세스(Process)란?

프로세스는 **실행 중인 프로그램(Program in Execution)** 을 의미한다.  
[운영체제](./운영체제란%20무엇인가%3F.md)는 프로세스를 관리하여 CPU, 메모리, 입출력 장치 등의 자원을 효율적으로 배분한다.  

### 프로세스의 특징
- 프로그램이 실행되면 운영체제로부터 **독립적인 메모리 공간**을 할당받는다.
- 하나의 프로세스는 최소 **코드(Code), 데이터(Data), 스택(Stack), 힙(Heap)** 영역을 가진다.
- 프로세스는 **PCB(Process Control Block)**라는 자료구조로 관리되며, 프로세스의 상태, 레지스터 값, 메모리 정보 등을 포함한다.

### 프로세스의 메모리 구조
1. **코드(Code) 영역**  
   - 실행할 프로그램의 명령어(기계어 코드)가 저장되는 공간  
   - 읽기 전용(Read-only) 속성을 가지며, 보통 모든 프로세스가 동일한 코드 영역을 공유한다.  
   - 프로그램의 함수, 제어문, 연산 코드 등이 위치한다.  

2. **데이터(Data) 영역**  
   - 전역 변수(Global variable), 정적 변수(Static variable)가 저장되는 공간  
   - 프로그램 시작과 동시에 할당되고, 종료될 때까지 유지된다.  

3. **힙(Heap) 영역**  
   - 프로그래머가 동적으로 메모리를 할당할 때 사용하는 공간 (예: `malloc`, `new`)  
   - 런타임에 크기가 가변적이며, 필요에 따라 메모리가 확장되거나 해제된다.  
   - 메모리 누수(Leak)가 발생할 수 있으므로 관리가 중요하다.  

4. **스택(Stack) 영역**  
   - 함수 호출 시 생성되는 지역 변수(Local variable), 매개변수(Parameter), 반환 주소(Return Address)가 저장되는 공간  
   - 함수가 종료되면 해당 스택 프레임이 해제된다.  
   - 후입선출(LIFO) 구조로 동작한다.  

---

## 2. 스레드(Thread)란?

스레드는 프로세스 내부에서 실행되는 **실행 단위의 흐름**이다.  
하나의 프로세스는 여러 개의 스레드를 가질 수 있으며, 이들을 **멀티스레드(Multi-thread)** 라 한다.  

### 스레드의 특징
- 프로세스 내 자원(코드, 데이터, 힙)을 공유한다.
- 독립적으로 스택(Stack)과 레지스터를 가진다.
- 스레드 간 문맥 교환(Context Switching)은 프로세스 간 교환보다 오버헤드가 작다.

---

## 3. 프로세스와 스레드의 차이점

| 구분 | 프로세스 | 스레드 |
|------|----------|---------|
| 정의 | 실행 중인 프로그램 | 프로세스 내 실행 흐름 |
| 메모리 | 독립된 메모리 영역 할당 (Code/Data/Stack/Heap) | Code/Data/Heap 공유, Stack만 독립 |
| 자원 공유 | 기본적으로 불가 | 같은 프로세스 내에서는 공유 가능 |
| 생성 비용 | 상대적으로 큼 | 상대적으로 작음 |
| 문맥 교환 | 비용이 큼 | 비용이 적음 |
| 안정성 | 독립성 보장 → 안정적 | 하나의 스레드 오류 시 전체 프로세스에 영향 |

---

## 4. 프로세스의 상태 (Process State)

프로세스는 실행 중에 여러 상태를 오간다.

- **생성(New)** : 프로세스가 생성되는 중  
- **준비(Ready)** : 실행할 준비가 되어 CPU를 기다리는 상태  
- **실행(Running)** : CPU를 점유하여 명령어를 수행하는 상태  
- **대기(Waiting/Blocked)** : 입출력 완료 등 특정 이벤트를 기다리는 상태  
- **종료(Terminated)** : 실행이 끝난 상태  

---

## 5. 프로세스 제어 블록 (PCB, Process Control Block)

운영체제는 실행 중인 프로세스를 **PCB(Process Control Block)**라는 자료구조로 관리한다.  
PCB는 프로세스의 신분증과 같으며, 문맥 교환 시 반드시 참조된다.  

### PCB에 저장되는 정보
- **프로세스 식별자(Process ID, PID)** : 프로세스를 구분하는 고유 번호  
- **프로세스 상태(Process State)** : New, Ready, Running, Waiting, Terminated  
- **프로그램 카운터(Program Counter)** : 다음에 실행될 명령어의 주소  
- **레지스터 값** : CPU 연산에 필요한 값들  
- **메모리 관리 정보** : 주소 공간, 페이지 테이블, 세그먼트 테이블 등  
- **CPU 스케줄링 정보** : 우선순위, 스케줄링 큐 위치, 시간 할당량  
- **입출력 상태 정보** : 사용 중인 파일, 입출력 장치 정보  

### PCB의 역할
- 현재 실행 중인 프로세스의 상태를 저장하여 **문맥 교환(Context Switching)** 시 사용한다.  
- 새로운 프로세스를 실행할 때 PCB의 정보를 CPU에 로드한다.  
- 따라서 PCB는 운영체제가 프로세스를 관리하는 데 있어 핵심적인 자료구조이다.  

---

## 6. 문맥 교환(Context Switching)

문맥 교환은 CPU가 현재 실행 중인 프로세스/스레드의 상태를 저장하고, 다른 프로세스/스레드로 교체하는 과정이다.  

- **프로세스 문맥 교환** : PCB 단위로 교체 → 비용이 큼  
- **스레드 문맥 교환** : 같은 프로세스 내에서 Stack만 교체 → 비용이 적음  

---

## 7. 멀티프로세스와 멀티스레드

### 멀티프로세스
- 여러 개의 독립된 프로세스를 동시에 실행하는 방식  
- 장점: 프로세스 간 독립성이 보장되어 안정성이 높음  
- 단점: 프로세스 간 통신(IPC)이 복잡하고 오버헤드가 큼  

### 멀티스레드
- 하나의 프로세스 내에서 여러 스레드를 병렬적으로 실행하는 방식  
- 장점: 자원 공유가 쉬워 효율적이고 문맥 교환 비용이 적음  
- 단점: 하나의 스레드 오류가 전체 프로세스에 영향을 줄 수 있음  

---

## 8. 정리

- 프로세스: 실행 단위 (자원 + 실행 흐름 포함)  
- 스레드: 프로세스 내 실행 흐름 단위  
- 프로세스는 Code, Data, Heap, Stack 4가지 메모리 영역으로 구성된다.  
- PCB: 프로세스를 운영체제가 관리하기 위한 핵심 자료구조  
- 멀티프로세스: 안정성 ↑, 비용 ↑  
- 멀티스레드: 효율성 ↑, 안정성 ↓  

운영체제는 상황에 따라 멀티프로세스와 멀티스레드를 적절히 활용한다.

---
